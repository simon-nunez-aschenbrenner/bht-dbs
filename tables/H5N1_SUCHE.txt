CREATE TABLE H5N1_SUCHE (ID INTEGER PRIMARY KEY, ZEITPUNKT TIMESTAMP(6), BEGRIFF VARCHAR(20) NOT NULL REFERENCES H5N1_BEGRIFF(BEGRIFF), NUTZER_IN INTEGER REFERENCES NUTZER_IN(ID), URL VARCHAR(200) REFERENCES WEBSEITE(URL), LAND VARCHAR(20) REFERENCES LAND(NAME))
INSERT INTO H5N1_SUCHE (ID, ZEITPUNKT, BEGRIFF, NUTZER_IN, URL, LAND) SELECT SEQUENCE.NEXTVAL, QUERYTIME, BEGRIFF, ANONID, CLICKURL, NAME FROM (AOLDATA.QUERYDATA JOIN H5N1_BEGRIFF ON QUERY LIKE '%'||BEGRIFF||'%') LEFT JOIN LAND ON QUERY LIKE '%'||NAME||'%'